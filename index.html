<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planner Settimanale</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f7f7f7;
        }
        header, footer {
            background-color: #4CAF50;
            color: white;
            text-align: center;
            padding: 10px 0;
        }
        header h1, footer p {
            margin: 0;
        }
        .container {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin: 20px;
        }
        .day {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .day h2 {
            text-align: center;
            margin: 0 0 10px;
        }
        .time-slot {
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
        }
        .time-slot.blue { background-color: #2196F3; color: white; }
        .time-slot.orange { background-color: #FF9800; color: white; }
        .time-slot.red { background-color: #F44336; color: white; }
        footer {
            margin-top: 20px;
        }
        footer .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        footer .legend div {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        footer .legend div span {
            display: inline-block;
            width: 15px;
            height: 15px;
            border-radius: 50%;
        }
        footer .legend div span.blue { background-color: #2196F3; }
        footer .legend div span.orange { background-color: #FF9800; }
        footer .legend div span.red { background-color: #F44336; }
        footer .legend div span.white { background-color: white; border: 1px solid #ccc; }
    </style>
</head>
<body>
    <header>
        <h1 id="week-title">Settimana</h1>
        <button id="prev-week">&larr; Settimana Precedente</button>
        <button id="next-week">Settimana Successiva &rarr;</button>
    </header>
    <main>
        <div class="container" id="planner-container"></div>
    </main>
    <footer>
        <div class="legend">
            <div><span class="blue"></span> Marco</div>
            <div><span class="orange"></span> Laura</div>
            <div><span class="red"></span> Abies</div>
            <div><span class="white"></span> Non prenotato</div>
        </div>
    </footer>
    <script>
        const CLIENT_ID = '786045326849-4524vek5urhk3lkdpml0kvqev2gboc1l.apps.googleusercontent.com';
        const API_KEY = 'AIzaSyCF2HZo60YJ9AXjWc79isscfwDgW2qzwmc';
        const DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];
        const SCOPES = "https://www.googleapis.com/auth/spreadsheets";

        const days = ["Lunedì", "Martedì", "Mercoledì", "Giovedì", "Venerdì", "Sabato", "Domenica"];
        const timeSlots = ["Mattina", "Pomeriggio", "Sera", "Notte"];
        let currentWeek = new Date();

        function getMonday(d) {
            d = new Date(d);
            const day = d.getDay(),
                diff = d.getDate() - day + (day === 0 ? -6 : 1); // Adjust for Monday (day 1)
            return new Date(d.setDate(diff));
        }

        function formatWeekRange(date) {
            const monday = getMonday(date);
            const sunday = new Date(monday);
            sunday.setDate(monday.getDate() + 6);

            const options = { day: '2-digit', month: '2-digit' };
            return `${monday.toLocaleDateString('it-IT', options)} - ${sunday.toLocaleDateString('it-IT', options)}`;
        }

        function updatePlanner() {
            const plannerContainer = document.getElementById("planner-container");
            const weekTitle = document.getElementById("week-title");

            weekTitle.textContent = `Settimana ${formatWeekRange(currentWeek)}`;
            plannerContainer.innerHTML = "";

            days.forEach(day => {
                const dayDiv = document.createElement("div");
                dayDiv.className = "day";
                const dayTitle = document.createElement("h2");
                dayTitle.textContent = day;
                dayDiv.appendChild(dayTitle);

                timeSlots.forEach(slot => {
                    const slotDiv = document.createElement("div");
                    slotDiv.className = "time-slot";
                    slotDiv.textContent = slot;
                    slotDiv.onclick = () => {
                        if (slotDiv.classList.contains("blue")) slotDiv.className = "time-slot orange";
                        else if (slotDiv.classList.contains("orange")) slotDiv.className = "time-slot red";
                        else if (slotDiv.classList.contains("red")) slotDiv.className = "time-slot";
                        else slotDiv.className = "time-slot blue";
                    };
                    dayDiv.appendChild(slotDiv);
                });

                plannerContainer.appendChild(dayDiv);
            });
        }

        document.getElementById("prev-week").onclick = () => {
            currentWeek.setDate(currentWeek.getDate() - 7);
            updatePlanner();
        };

        document.getElementById("next-week").onclick = () => {
            currentWeek.setDate(currentWeek.getDate() + 7);
            updatePlanner();
        };

        document.addEventListener("DOMContentLoaded", () => {
            updatePlanner();
        });
    </script>
</body>
</html>

